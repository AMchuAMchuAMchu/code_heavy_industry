(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{1600:function(t,a,s){t.exports=s.p+"assets/img/img001.e59f98be.png"},1601:function(t,a,s){t.exports=s.p+"assets/img/img005.3e2b73ba.png"},2390:function(t,a,s){"use strict";s.r(a);var r=s(54),v=Object(r.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p"),r("div",{staticClass:"table-of-contents"},[r("ul",[r("li",[r("a",{attrs:{href:"#_1、栈帧存储的数据"}},[t._v("1、栈帧存储的数据")])]),r("li",[r("a",{attrs:{href:"#_2、栈帧的结构"}},[t._v("2、栈帧的结构")])]),r("li",[r("a",{attrs:{href:"#_3、栈帧工作机制"}},[t._v("3、栈帧工作机制")])]),r("li",[r("a",{attrs:{href:"#_4、典型案例"}},[t._v("4、典型案例")])])])]),r("p"),t._v(" "),r("h1",{attrs:{id:"第二节-栈帧"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第二节-栈帧"}},[t._v("#")]),t._v(" 第二节 栈帧")]),t._v(" "),r("h2",{attrs:{id:"_1、栈帧存储的数据"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、栈帧存储的数据"}},[t._v("#")]),t._v(" 1、栈帧存储的数据")]),t._v(" "),r("p",[t._v("方法在本次执行过程中所用到的局部变量、动态链接、方法出口等信息。栈帧中主要保存3 类数据：")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("本地变量（Local Variables）：输入参数和输出参数以及方法内的变量。")])]),t._v(" "),r("li",[r("p",[t._v("栈操作（Operand Stack）：记录出栈、入栈的操作。")])]),t._v(" "),r("li",[r("p",[t._v("栈帧数据（Frame Data）：包括类文件、方法等等。")])])]),t._v(" "),r("h2",{attrs:{id:"_2、栈帧的结构"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、栈帧的结构"}},[t._v("#")]),t._v(" 2、栈帧的结构")]),t._v(" "),r("ul",[r("li",[t._v("局部变量表：方法执行时的参数、方法体内声明的局部变量")]),t._v(" "),r("li",[t._v("操作数栈：存储中间运算结果，是一个临时存储空间")]),t._v(" "),r("li",[t._v("帧数据区：保存访问常量池指针，异常处理表")])]),t._v(" "),r("h2",{attrs:{id:"_3、栈帧工作机制"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3、栈帧工作机制"}},[t._v("#")]),t._v(" 3、栈帧工作机制")]),t._v(" "),r("p",[t._v("当一个方法 A 被调用时就产生了一个栈帧 F1，并被压入到栈中，")]),t._v(" "),r("p",[t._v("A 方法又调用了 B 方法，于是产生栈帧 F2 也被压入栈，")]),t._v(" "),r("p",[t._v("B 方法又调用了 C 方法，于是产生栈帧 F3 也被压入栈，")]),t._v(" "),r("p",[t._v("……")]),t._v(" "),r("p",[t._v("C 方法执行完毕后，弹出 F3 栈帧；")]),t._v(" "),r("p",[t._v("B 方法执行完毕后，弹出 F2 栈帧；")]),t._v(" "),r("p",[t._v("A 方法执行完毕后，弹出 F1栈帧；")]),t._v(" "),r("p",[t._v("……")]),t._v(" "),r("p",[t._v("遵循“先进后出”或者“后进先出”原则。")]),t._v(" "),r("p",[r("img",{attrs:{src:s(1600),alt:"images"}})]),t._v(" "),r("p",[t._v("图示在一个栈中有两个栈帧：")]),t._v(" "),r("p",[t._v("栈帧 2 是最先被调用的方法，先入栈，")]),t._v(" "),r("p",[t._v("然后方法 2 又调用了方法 1，栈帧 1 处于栈顶的位置，")]),t._v(" "),r("p",[t._v("栈帧 2 处于栈底，执行完毕后，依次弹出栈帧 1 和栈帧 2，")]),t._v(" "),r("p",[t._v("线程结束，栈释放。")]),t._v(" "),r("p",[t._v("每执行一个方法都会产生一个栈帧，保存到栈的"),r("span",{staticStyle:{color:"blue","font-weight":"bold"}},[t._v("顶部")]),t._v("，顶部栈就是"),r("span",{staticStyle:{color:"blue","font-weight":"bold"}},[t._v("当前方法")]),t._v("，该方法执行完毕后会自动将此栈帧出栈。")]),t._v(" "),r("h2",{attrs:{id:"_4、典型案例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4、典型案例"}},[t._v("#")]),t._v(" 4、典型案例")]),t._v(" "),r("p",[t._v("请预测下面代码打印的结果：34")]),t._v(" "),r("div",{staticClass:"language-java line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-java"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" n "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nn "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),r("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br")])]),r("p",[t._v("实际执行结果：32")]),t._v(" "),r("p",[t._v("使用 javap 命令查看字节码文件内容：")]),t._v(" "),r("blockquote",[r("p",[t._v("D:\\record-video-original\\day03\\code>"),r("span",{staticStyle:{color:"blue","font-weight":"bold"}},[t._v("javap -c Demo03JavaStackExample.class")]),r("br"),t._v('\nCompiled from "Demo03JavaStackExample.java"'),r("br"),t._v("\npublic class Demo03JavaStackExample{"),r("br"),t._v("\npublic Demo03JavaStackExample();"),r("br"),t._v("\nCode:"),r("br"),t._v("\n0: aload_0"),r("br"),t._v('\n1: invokespecial #1                  // Method java/lang/Object."<init>: ()V'),r("br"),t._v("\n4: return"),r("br")]),t._v(" "),r("p",[t._v("public static void main(java.lang.String[]);"),r("br"),t._v("\nCode:"),r("br"),t._v("\n0: bipush        10"),r("br"),t._v("\n2: istore_1"),r("br"),t._v("\n3: iload_1"),r("br"),t._v("\n4: iload_1"),r("br"),t._v("\n5: iinc          1, 1"),r("br"),t._v("\n8: iinc          1, 1"),r("br"),t._v("\n11: iload_1"),r("br"),t._v("\n12: iadd"),r("br"),t._v("\n13: iadd"),r("br"),t._v("\n14: istore_1"),r("br"),t._v("\n15: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;"),r("br"),t._v("\n18: iload_1"),r("br"),t._v("\n19: invokevirtual #3                  // Method java/io/PrintStream.println:(I)V"),r("br"),t._v("\n22: return"),r("br"),t._v("\n}")])]),t._v(" "),r("p",[t._v("内存执行过程分析：")]),t._v(" "),r("p",[r("img",{attrs:{src:s(1601),alt:"images"}})]),t._v(" "),r("p",[r("RouterLink",{attrs:{to:"/pro016-JVM/lecture/chapter05/verse01.html"}},[t._v("上一节")]),t._v(" "),r("RouterLink",{attrs:{to:"/pro016-JVM/lecture/chapter05/index.html"}},[t._v("回目录")]),t._v(" "),r("RouterLink",{attrs:{to:"/pro016-JVM/lecture/chapter05/verse03.html"}},[t._v("下一节")])],1)])}),[],!1,null,null,null);a.default=v.exports}}]);